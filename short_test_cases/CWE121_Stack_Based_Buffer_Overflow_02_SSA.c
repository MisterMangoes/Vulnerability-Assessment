/*
Program description: In this program, if globalString is equal to "helloworld", data is assigned a value from standard input with fgets() and buffer is initialized as an integer array of size 10 that is filled with 0's. Then, the element at index data in buffer is assigned as 9 and the elements of buffer is printed out with a for loop 

Vulnerability and consequence: However, there is no check to see if the index data is out of bounds for the buffer array. If data is assigned an integer greater than 9, the index will overrun the upper boundary of buffer and the program will overwrite adjacent memory with 9, thus causing a stack buffer overflow

The vulnerability triggers in the following lines:
buffer[data] = 9;

Mitigation: To make this program safe to run, ensure that the index data will not exceed the upper bound of the buffer array. Use an if condition to check if the data is a suitable index for buffer and it will not overrun the upper bound of the array to avoid overwriting adjacent memory
*/

#include <stdio.h>
#include <assert.h>

int main() {
	int data = 0;
	char inputBuffer[10];
	int * data_1 = &data;
	if (fgets(inputBuffer, 10, stdin) != NULL) {
		*data_1 = atoi(inputBuffer); //convert to int
	}
	int buffer[10];
	memset(buffer, 0, 10 * sizeof(int));
	assert(data < sizeof(buffer)/sizeof(buffer[0]));
	int * buffer_1 = &buffer[data];
	*buffer_1 = 9;
	return 0;
}