/*
Program description: In this program, data is allocated with 15 bytes. Then, an integer array of size 15, source, is initialized with 3's and is copied to data using a for loop

Vulnerability and consequence: However, when allocating the memory for data, sizeof(int) is not used, so the storage space for data is only for 15 bytes, not of 15 integers. Therefore, a heap buffer overflow would occur when source is copied to data because it overruns the memory that has been allocated for data

The vulnerability triggers in the following lines:
for (i = 0; i < 15; i++) {
	data[i] = source[i];
}

Mitigation: To make this program safe to run, ensure that the memory space allocated for data is equal to or greater than the size of 15 integers (the number of integers in source). Use sizeof(int) when allocating space for data
*/

#include <stdlib.h>
#include <assert.h>

int main() {
	int * data = NULL;
	int dataMemorySize = 15;
	data = (int *)malloc(dataMemorySize);
	int source[15] = {3};
	assert(dataMemorySize >= sizeof(source));
	for (int i = 0; i < 15; i++) {
		data[i] = source[i];
	}
	free(data);
	return 0;
}