/*
Program description: In this program, number is initialized as 6 and intPointer points to the address of number. intPointer is set to NULL, and if intPointer is set to NULL, the integer in the memory location that intPointer points to is multiplied by 9 and is stored in number

Vulnerability and consequence: However, even though there is a NULL check for intPointer, the program still dereferences the pointer. Therefore, when intPointer is equal to NULL, multiplying the integer in the memory location that intPointer points to with 9 results in a NULL pointer dereference

The vulnerability triggers in the following lines:
number = *intPointer * 9;

Mitigation: To make this program safe to run, ensure that intPointer is not dereferenced when it is NULL. Do not dereference intPointer if NULL is true
*/

#include <stdlib.h>
#include <assert.h>

int main() {
	int number = 6;
	int * intPointer = &number;
	intPointer = NULL;
	if (intPointer == NULL) {
		assert(intPointer != NULL);
		number = *intPointer * 9;
	}
	printf("%d\n", number);
	return 0;
}