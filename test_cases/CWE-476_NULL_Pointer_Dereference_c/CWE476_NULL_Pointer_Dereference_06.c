/*
Program description: In this program, data is initialized as a NULL 64-bit integer pointer, which is passed as an argument to the function badSink_a(). badSink_a() passes data to another function, badSink_b(), which prints out data if badStatic is equal to 1

Vulnerability and consequence: However, data initialized as NULL and the pointer is not assigned to a memory block. Therefore, when data is dereferenced to be printed out, a NULL pointer dereference occurs

The vulnerability triggers in the following lines:
printf("%ld\n", *data);

Mitigation: To make this program safe to run, ensure that data is not set to NULL. data should point to an address after it is initialized instead of leaving it as NULL if there is a use. Perform a NULL check to ensure that data is not NULL
*/

#include <stdlib.h>
#include <inttypes.h>
#include <assert.h>

static int badStatic = 0;

static void badSink_b(int64_t * data) {
	if(badStatic) {
		assert(data != NULL);
		printf("%ld\n", *data);
	}
}

void badSink_a(int64_t * data) {
	badSink_b(data);
}

int main() {
	int64_t * data = NULL;
	badStatic = 1;
	badSink_a(data);
	return 0;
}