/*
Program description: In this program, data is allocated memory for 10 longs. Using a for loop, the elements of data is assigned to different values. Then data is set to NULL and the element at index 2 and 5 in data are added together, in which the result is stored in the long, addition, which is printed out

Vulnerability and consequence: However, after data is set to NULL, the program dereferences data to add the element at index 2 and 5 together. Therefore, a NULL pointer dereference occurs

The vulnerability triggers in the following lines:
long addition = data[2] + data[5];

Mitigation: To make this program safe to run, ensure that data is not set to NULL if there are more uses. Perform a NULL check to ensure that data is not NULL
*/

#include <stdlib.h>
#include <assert.h>

int main() {
	long * data = (long *)malloc(10 * sizeof(long));
	for(int i = 0; i < 10; i++) {
		data[i] = i;
	}
	data = NULL;
	assert(data != NULL);
	long addition = data[2] + data[5];
	printf("%ld\n", addition);
	return 0;
}