/*
Program description: In this program, an integer pointer a and an integer b is initialized. The memory location that a points to is assigned as 5, and b is assigned as 5. Then, a is dereferenced and a and b are passed as arguments to the addition function. In the addition function, the integer result is assigned a value that is equal to the addition of the two integer arguments, a and b. resultPointer is assigned to the address of result and is returned from the addition function, which is later dereferenced in the main function to print the sum of a and b

Vulnerability and consequence: However, after resultPointer is assigned to the address of result, resultPointer is set to NULL before being returned. Therefore, in the main function, when resultPointer is derferenced to print out the sum of a and b, a NULL pointer dereference occurs

The vulnerability triggers in the following lines:
printf("Addition result: %d\n", *resultPointer);

Mitigation: To make this program safe to run, ensure that resultPointer is not set to NULL if there are more uses. Perform a NULL check to ensure that resultPointer is not NULL
*/

#include <stdlib.h>
#include <assert.h>

int * addition(int a, int b) {
	int result = (a + b);
	int * resultPointer = &result;
	resultPointer = NULL;
	return resultPointer;
}

int main() {
	int number = 5;
	int * a = NULL;
	int b = 1;
	a = &number;
	b = *a;
	printf("First number: %d\n", *a);
	printf("Second number: %d\n", b);
	int * resultPointer = addition(*a, b);
	assert(resultPointer != NULL);
	printf("Addition result: %d\n", *resultPointer);
	return 0;
}