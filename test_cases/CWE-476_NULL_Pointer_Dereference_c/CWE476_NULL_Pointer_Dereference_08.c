/*
Program description: In this program, the twoIntsStruct pointer, badData, is assigned to NULL, then the function badFunction() is called. Within badFunction(), the twoIntsStruct pointer data is assigned to badData and the first integer contained in data, data->intOne, is printed out

Vulnerability and consequence: However, because badData is set to NULL, data is also set to NULL when it is assigned to badData. Therefore, when printing out data->intOne, a NULL pointer dereference occurs

The vulnerability triggers in the following lines:
printf("%d\n", data->intOne);

Mitigation: To make this program safe to run, ensure that data is not set to NULL. data should not be assigned to a pointer that is set to NULL. Perform a NULL check to ensure that data is not NULL
*/

#include <stdlib.h>
#include <assert.h>

typedef struct _twoIntsStruct {
	int intOne;
	int intTwo;
} twoIntsStruct;

twoIntsStruct * badData;

void badFunction() {
	twoIntsStruct * data = badData;
	assert(data != NULL);
	printf("%d\n", data->intOne);
}

int main() {
	twoIntsStruct * data = NULL;
	badData = data;
	badFunction();
	return 0;
}