//CWE476_NULL_Pointer_Dereference__int64_t_82

#include <cstdio>
#include <cinttypes>
#include <cassert>

class CWE476_NULL_Pointer_Dereference__int64_t_82_base
{
public:
    /* pure virtual function */
    virtual void action(int64_t * data) = 0;
};

class CWE476_NULL_Pointer_Dereference__int64_t_82_bad : public CWE476_NULL_Pointer_Dereference__int64_t_82_base
{
public:
    void action(int64_t * data);
};

void CWE476_NULL_Pointer_Dereference__int64_t_82_bad::action(int64_t * data)
{
    /* POTENTIAL FLAW: Attempt to use data, which may be NULL */
    assert(data != NULL);
    printf("%ld\n", *data);
}

int main()
{
    int64_t * data;
    /* POTENTIAL FLAW: Set data to NULL */
    data = NULL;
    CWE476_NULL_Pointer_Dereference__int64_t_82_base* baseObject = new CWE476_NULL_Pointer_Dereference__int64_t_82_bad;
    baseObject->action(data);
    delete baseObject;
    printf("%s\n", "finished");
    return 0;
}