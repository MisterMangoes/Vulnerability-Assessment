//CWE476_NULL_Pointer_Dereference__int64_t_72

#include <cstdio>
#include <cinttypes>
#include <vector>
#include <cassert>

using namespace std;

void badSink(vector<int64_t *> dataVector)
{
    /* copy data out of dataVector */
    int64_t * data = dataVector[2];
    /* POTENTIAL FLAW: Attempt to use data, which may be NULL */
    assert(data != NULL);
    printf("%" PRId64 "\n", *data);
}

int main()
{
    int64_t * data;
    vector<int64_t *> dataVector;
    /* POTENTIAL FLAW: Set data to NULL */
    data = NULL;
    /* Put data in a vector */
    dataVector.insert(dataVector.end(), 1, data);
    dataVector.insert(dataVector.end(), 1, data);
    dataVector.insert(dataVector.end(), 1, data);
    badSink(dataVector);
    printf("%s\n", "finished");
    return 0;
}