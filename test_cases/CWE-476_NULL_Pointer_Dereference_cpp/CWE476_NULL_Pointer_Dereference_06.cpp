//CWE476_NULL_Pointer_Dereference__long_21

#include <cstdio>
#include <cassert>

static int badStatic = 0;

static void badSink(long * data)
{
    if(badStatic)
    {
        /* POTENTIAL FLAW: Attempt to use data, which may be NULL */
        assert(data != NULL);
        printf("%ld\n", *data);
    }
}

int main()
{
    long * data;
    /* POTENTIAL FLAW: Set data to NULL */
    data = NULL;
    badStatic = 1; /* true */
    badSink(data);
    printf("%s\n", "finished");
    return 0;
}