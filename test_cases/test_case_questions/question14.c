#include <wchar.h>
#include <assert.h>

#define ALLOCA alloca

static wchar_t * badData = NULL;

int dataArraySize = 100;

static void badSink() {
	wchar_t * data = badData;
	wchar_t dest[50] = L"";
	//assert(sizeof(dest) <= sizeof(data));
	//assert(dataArraySize <= ((sizeof(dest)/sizeof(dest[0])) - wcslen(dest)));
	wcscat(dest, data);
}

int main() {
	wchar_t * data = (wchar_t *)ALLOCA(dataArraySize * sizeof(wchar_t));
	//assert(dataArraySize - 1 <= (sizeof(data)/sizeof(data[0])));
	wmemset(data, L'A', dataArraySize - 1);
	//assert(dataArraySize - 1 <= (sizeof(data)/sizeof(data[0])));
	data[dataArraySize - 1] = L'\0';
	badData = data;
	badSink();
	return 0;
}

/*
Question: Which of the following is correct?
a) To catch this bug, the assertion at line 20 should be added
b) To catch this bug, the assertion at line 22 should be added
c) To catch this bug, the assertion at line 13 should be added
d) To catch this bug, the assertion at line 14 should be added
*/