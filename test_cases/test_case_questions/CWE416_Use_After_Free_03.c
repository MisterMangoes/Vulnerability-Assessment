#include <stdlib.h>
#include <assert.h>

int main()  {
	char inputBuffer[] = "hhhi";
	char *dst_buf = NULL;
	dst_buf = (char*)malloc(5 * sizeof(char) * strlen(inputBuffer));
	int dst_index = 0;
	for (int i = 0; i < strlen(inputBuffer) + 1; i++) {
		if('h' == inputBuffer[i] ) {
			dst_buf[dst_index++] = 'h';
			dst_buf[dst_index++] = 'e';
			dst_buf[dst_index++] = 'l';
			dst_buf[dst_index++] = 'l';
			dst_buf[dst_index++] = 'o';
		}
		else {
			dst_buf[dst_index++] = inputBuffer[i];
		}
	}
	free(dst_buf);
	printf("%s\n", dst_buf);
	return 0;
}

/*
Question: Which of the following is NOT correct?
a) The code has a use after free at line 21
b) The code has a heap buffer overflow in the for loop at line 9 because the string expansion overruns the space of the buffer 
c) The index for dst_buf in the for loop at line 9 does not cause a heap buffer overflow because it does not exceed the upper bound of the buffer
d) sizeof(char) should be used when allocating memory for dst_buf at line 7
*/