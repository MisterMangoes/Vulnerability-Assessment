#include <wchar.h>
#include <assert.h>

int globalReturnsTrueOrFalse() {
	srand(time(0)); //use current time as seed
	return (rand() % 2);
}

int main() {
	int dataFreed = 0;
	wchar_t * data = NULL;
	int dataAllocated = 0;
	if(globalReturnsTrueOrFalse()) {
		dataAllocated = 1;
		int dataMemorySize = 100 * sizeof(wchar_t);
		data = (wchar_t *)malloc(dataMemorySize);
		//assert(data != NULL);
		wmemset(data, L'A', 100 - 1);
		//assert(100 - 1 < dataMemorySize/sizeof(wchar_t));
		data[100 - 1] = L'\0';
		free(data);
		dataFreed = 1;
	}
	if(dataAllocated && globalReturnsTrueOrFalse()) {
		//assert(data != NULL);
		//assert(!dataFreed);
		wprintf(L"%ls\n", data);
	}
	return 0;
}

/*
Question: Which of the following is correct?
a) To catch this bug, the assertion at line 26 should be added
b) To catch this bug, the assertion at line 17 should be added
c) To catch this bug, the assertion at line 25 should be added
d) To catch this bug, the assertion at line 19 should be added
*/