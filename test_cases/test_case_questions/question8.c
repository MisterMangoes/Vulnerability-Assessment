#include <stdlib.h>
#include <assert.h>

static char * helperBad(char * aString) {
	if (aString != NULL) {
		int strLength = strlen(aString);
		char * reversedString = (char *)malloc(strLength + 1);
		for (int i = 0; i < strLength; i++) {
			reversedString[i] = aString[strLength - i - 1];
		}
		reversedString[strLength] = '\0';
		free(reversedString);
		return reversedString;
	}
	else {
		return NULL;
	}
}

int main() {
	char * reversedString = NULL;
	reversedString = helperBad("BadSink");
	printf("%s\n", reversedString);
	return 0;
}

/*
Question: Which of the following is correct?
a) A heap buffer overflow occurs in the for loop at line 8
b) A null pointer dereference occurs at line 23
c) A use after free occurs at line 13
d) A heap buffer overflow occurs at line 11
*/