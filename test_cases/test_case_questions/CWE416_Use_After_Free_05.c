#include <stdlib.h>
#include <assert.h>

static char * helperBad(char * aString) {
	if (aString != NULL) {
		int i = strlen(aString);
		char * reversedString = (char *)malloc(i + 1);
		for (int j = 0; j < i; j++) {
			reversedString[j] = aString[i - j - 1];
		}
		reversedString[i] = '\0';
		free(reversedString);
		return reversedString;
	}
	else {
		return NULL;
	}
}

int main() {
	char * reversedString = NULL;
	reversedString = helperBad("BadSink");
	printf("%s\n", reversedString);
	return 0;
}

/*
Question: Which of the following is correct?
a) A heap buffer overflow occurs in the for loop at line 8
b) A null pointer dereference occurs at line 23
c) A use after free occurs at line 13
d) A heap buffer overflow occurs at line 11
*/