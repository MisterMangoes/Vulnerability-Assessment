/*
Program description: In this program, source is a character array with a size of 100 that is filled with C's and the last character is replaced with a terminating character. Then, source is copied to data using strcpy()

Vulnerability and consequence: However, the array size for source is 100 characters but the array size for data is only 50. Therefore, when source is copied onto data, adjacent memory is overwritten and causes a stack buffer overflow

The vulnerability triggers in the following lines:
strcpy(data, source);

Mitigation: To make this program safe to run, ensure that the storage size of data is equal to or greater than the storage size of source so that the copy from source to data does not overwrite adjacent memory
*/

#include <assert.h>

int main() {
	int dataBadBufferArraySize = 50;
	char data[dataBadBufferArraySize];
	char * data_1 = &data[0];
	*data_1 = '\0';
	{
		char * dataCopy = data_1;
		{
			int sourceArraySize = 100;
			char source[sourceArraySize];
			memset(source, 'C', sourceArraySize-1);
			assert(dataBadBufferArraySize >= sourceArraySize);
			strcpy(dataCopy, source);
			printf("%s\n", dataCopy);
		}
	}
	return 0;
}