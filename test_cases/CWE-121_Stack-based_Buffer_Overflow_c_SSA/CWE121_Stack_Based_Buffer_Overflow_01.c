/*
Program description: In this program, two character arrays with a size of 20 are declared, realPassword and givenPassword. realPassword contains the string for a password and givenPassword is used to store the string given by standard input with fgets(). If givenPassword equals realPassword, then a success message is outputted. Otherwise, if they do not match, a failure message is outputted

Vulnerability and consequence: However, a maximum of 24 characters is read from standard input using fgets() and is stored in givenPassword, but givenPassword is only allocated memory for 20 characters. Therefore, if there are more than 20 characters read by fgets(), it will overrun the boundary of givenPassword and overwrite adjacent memory, thus causing a stack buffer overflow

The vulnerability triggers in the following lines:
fgets(givenPassword, charactersRead, stdin);

Mitigation: To make this program safe to run, ensure that the maximum number of characters read by fgets() does not exceed the number of characters that can be stored in givenPassword to avoid overwriting adjacent memory
*/

#include <stdio.h>
#include <assert.h>

int main() {
	char realPassword[20];
	char givenPassword[20];
	strncpy(realPassword, "realPassword", 20);
	int charactersRead = 20;
	assert(sizeof(givenPassword)/sizeof(givenPassword[0]) >= charactersRead);
	fgets(givenPassword, charactersRead, stdin);
	if (!strncmp(givenPassword, realPassword, 12)) {
		printf("SUCCESS!\n");
	}
	else {
		printf("FAILURE!\n");
	}
	printf("givenPassword: %s\n", givenPassword);
	printf("realPassword: %s\n", realPassword);
	return 0;
}