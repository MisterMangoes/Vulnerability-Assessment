/*
Program description: In this program, data is allocated memory for 75 longs, which are all assigned as 2 using a for loop, then data is set to NULL. Then, within another while loop, the element at index 10 of data is assigned as 10 

Vulnerability and consequence: However, after data is set to NULL, the program assigns the element at index 10 of data as 10, which causes a NULL pointer dereference

The vulnerability triggers in the following lines:
data[10] = 10L;

Mitigation: To make this program safe to run, ensure that data is not set to NULL if there are more uses. Perform a NULL check to ensure that data is not NULL
*/

#include <stdlib.h>
#include <assert.h>

int main() {
	long * data = (long *)malloc(75 * sizeof(long));
	for(int i = 0; i < 75; i++) {
		data[i] = 2L;
	}
	data = NULL;
	assert(data != NULL);
	data[10] = 10L;
	free(data);
	return 0;
}

//Original file: CWE476_NULL_Pointer_Dereference_02

/*
Question: Which of the following is correct? C
a) A heap buffer overflow occurs in the for loop  at line 17
b) A null pointer dereference occurs at line 22
c) A stack buffer overflow occurs in the for loop at line 17
d) A heap buffer overflow occurs at line 22
*/