//CWE416_Use_After_Free__new_delete_class_18

#include <cstdio>
#include <cassert>

class TwoIntsClass 
{
    public: // Needed to access variables from label files
        int intOne;
        int intTwo;
};

int main()
{
    TwoIntsClass * data;
    /* Initialize data */
    data = NULL;
    goto source;
source:
    data = new TwoIntsClass;
    data->intOne = 1;
    data->intTwo = 2;
    /* POTENTIAL FLAW: Delete data in the source - the bad sink attempts to use data */
    delete data;
    data = NULL;
    goto sink;
sink:
    /* POTENTIAL FLAW: Use of data that may have been deleted */
    assert(data != NULL);
    printf("%d\n", data->intOne);
    /* POTENTIAL INCIDENTAL - Possible memory leak here if data was not deleted */
    printf("%s\n", "finished");
    return 0;
}