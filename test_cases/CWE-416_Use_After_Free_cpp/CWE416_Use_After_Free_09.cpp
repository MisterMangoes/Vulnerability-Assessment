//CWE416_Use_After_Free__new_delete_int64_t_15

#include <cstdio>
#include <cinttypes>
#include <cassert>

int main()
{
    int64_t * data;
    /* Initialize data */
    data = NULL;
    switch(6)
    {
    case 6:
        data = new int64_t;
        *data = 5LL;
        /* POTENTIAL FLAW: Delete data in the source - the bad sink attempts to use data */
        delete data;
        data = NULL;
        break;
    default:
        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */
        printf("%s\n", "Benign, fixed string");
        break;
    }
    switch(7)
    {
    case 7:
        /* POTENTIAL FLAW: Use of data that may have been deleted */
        assert(data != NULL);
        printf("%" PRId64 "\n", *data);
        /* POTENTIAL INCIDENTAL - Possible memory leak here if data was not deleted */
        break;
    default:
        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run */
        printf("%s\n", "Benign, fixed string");
        break;
    }
    printf("%s\n", "finished");
    return 0;
}