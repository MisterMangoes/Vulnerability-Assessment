//CWE416_Use_After_Free__new_delete_long_12

#include <cstdio>
#include <cstdlib> 
#include <cassert>

int main()
{
    long * data;
    /* Initialize data */
    data = NULL;
    if(rand() % 2)
    {
        data = new long;
        *data = 5L;
        /* POTENTIAL FLAW: Delete data in the source - the bad sink attempts to use data */
        delete data;
        data = NULL;
    }
    else
    {
        data = new long;
        *data = 5L;
        /* FIX: Do not delete data in the source */
    }
    if(rand() % 2)
    {
        /* POTENTIAL FLAW: Use of data that may have been deleted */
        assert(data != NULL);
        printf("%ld\n", *data);
        /* POTENTIAL INCIDENTAL - Possible memory leak here if data was not deleted */
    }
    else
    {
        /* FIX: Don't use data that may have been deleted already */
        /* POTENTIAL INCIDENTAL - Possible memory leak here if data was not deleted */
        /* do nothing */
        ; /* empty statement needed for some flow variants */
    }
    printf("%s\n", "finished");
    return 0;
}